{"version":3,"file":"blocks/post-list/frontend.js","mappings":"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","sources":["webpack://zoloblocks/./src/blocks/post-list/frontend.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\n  // Declare globally\n  const pageContentCache = new Map();\n  const PAGINATION_WRAP_CLASS = 'zolo-pagination-wrap';\n  let paginationType = null;\n  let blockName = null;\n  let isLoading = false;\n\n  const createPreloader = () => {\n    const preloader = document.createElement('div');\n    preloader.classList.add('preloader');\n    preloader.innerHTML = `<div class=\"container\"><div class=\"dot\"></div><div class=\"dot\"></div><div class=\"dot\"></div><div class=\"dot\"></div><div class=\"dot\"></div></div>`;\n    return preloader;\n  };\n\n  const fetchContent = async (wrapper, pageNumber, settings, useCache = false) => {\n    if (useCache && pageContentCache.has(pageNumber)) {\n      const cachedContent = pageContentCache.get(pageNumber);\n      wrapper.innerHTML = '';\n      wrapper.insertAdjacentHTML('beforeend', cachedContent);\n      reinitPaginationListeners();\n      return;\n    }\n\n    const preloader = createPreloader();\n    const itemWrapper = wrapper.querySelector('.zolo-block');\n    const paginationWrap = wrapper.querySelector(`.${PAGINATION_WRAP_CLASS}`);\n\n    if (itemWrapper) {\n      itemWrapper.appendChild(preloader);\n    }\n\n    try {\n      const formData = new FormData();\n      formData.append('action', 'zolo_ajax_post_pagination');\n      formData.append('pageNumber', pageNumber);\n      formData.append('settings', settings);\n      formData.append('zolo_nonce', zoloSettings.zolo_nonce);\n\n      const response = await fetch(zoloSettings.ajaxurl, {\n        method: 'POST',\n        body: formData,\n      });\n\n      const result = await response.json();\n      if (result.success) {\n\n        if (useCache) {\n          pageContentCache.set(pageNumber, result.data); // Cache the content\n        }\n\n        if (paginationType === 'number') {\n          wrapper.innerHTML = '';\n          wrapper.insertAdjacentHTML('beforeend', result.data);\n          reinitPaginationListeners();\n        }\n\n        if (paginationType === 'button' || paginationType === 'scroll') {\n          const tempDiv = document.createElement('div');\n          tempDiv.innerHTML = result.data;\n          const postItems = tempDiv.querySelectorAll('.zolo-post-item');\n          if (postItems.length > 0) {\n            postItems.forEach(postItem => {\n              itemWrapper.appendChild(postItem);\n            });\n          } else {\n            paginationWrap.innerHTML = \"\";\n          }\n        }\n      } else {\n        console.error('Failed to fetch content:', result);\n      }\n    } catch (error) {\n      console.error('Error fetching content:', error);\n    } finally {\n      if (itemWrapper) {\n        itemWrapper.removeChild(preloader); // Remove the preloader\n      }\n\n      isLoading = false;\n    }\n  };\n\n  const getPageLink = href => href.includes('admin-ajax.php') ? href.match(/admin-ajax.*/)?.[0] || '' : href.match(/\\/page\\/\\d+\\//)?.[0] || '';\n\n  const getPageNumber = link => {\n    const match = link.match(/\\d+/);\n    return match ? parseInt(match[0], 10) : 1;\n  };\n\n  const reinitPaginationListeners = () => {\n    const updatedPaginationElements = document.querySelectorAll(`.${PAGINATION_WRAP_CLASS}`);\n    updatedPaginationElements.forEach(initPaginationListeners);\n  };\n\n  //only form ajax number pagination\n  const handlePaginationClick = async event => {\n    event.preventDefault();\n\n    // Prevent multiple requests when already loading\n    if (isLoading) return;\n\n    isLoading = true;\n\n    const href = event.target.getAttribute('href');\n    if (!href) return;\n\n    const pageLink = getPageLink(href);\n    const pageNumber = getPageNumber(pageLink);\n\n    blockName = event.target.closest(`.${PAGINATION_WRAP_CLASS}`).dataset.blockname;\n    paginationType = event.target.closest(`.${PAGINATION_WRAP_CLASS}`).dataset.paginationtype;\n    const blockWrapper = event.target.closest(`.wp-block-zolo-${blockName}`);\n\n    if (blockWrapper) {\n      const blockSettings = blockWrapper.dataset.attributes;\n      await fetchContent(blockWrapper, pageNumber, blockSettings, true);\n      isLoading = false;\n    }\n  };\n\n  const addClickListeners = (elements, handler) => {\n    elements.forEach(element => element.addEventListener('click', handler));\n  };\n\n  //only for ajax load more on click pagination\n  const handleButtonPagination = paginationElement => {\n    const button = paginationElement.querySelector('.zolo-pagination-button');\n\n    if (button) {\n      let pageNumber = parseInt(button.dataset.pagenumber, 10) || 1;\n      button.addEventListener('click', async event => {\n        event.preventDefault();\n\n        // Prevent multiple requests when already loading\n        if (isLoading) return;\n\n        // Set loading state\n        isLoading = true;\n        button.classList.add('loading');\n\n        pageNumber += 1;\n\n        paginationType = paginationElement.dataset.paginationtype;\n        blockName = paginationElement.dataset.blockname;\n        const blockWrapper = event.target.closest(`.wp-block-zolo-${blockName}`);\n\n        if (blockWrapper) {\n          const blockSettings = blockWrapper.dataset.attributes;\n          await fetchContent(blockWrapper, pageNumber, blockSettings);\n          // Remove loading state after fetching content\n          isLoading = false;\n          button.classList.remove('loading');\n        }\n      });\n    }\n  };\n//only for ajax scroll pagination\n  const handleScrollPagination = paginationElement => {\n    let pageNumber = parseInt(paginationElement.dataset.pagenumber, 10) || 1;\n    paginationType = paginationElement.dataset.paginationtype;\n    blockName = paginationElement.dataset.blockname;\n    const totalPage = paginationElement.dataset.totalpage;\n\n    window.addEventListener('scroll', () => {\n      // Prevent multiple requests when already loading\n      if (isLoading) return;\n\n      const scrollPosition = window.scrollY + window.innerHeight;\n      const documentHeight = document.documentElement.offsetHeight;\n\n      if (scrollPosition >= documentHeight - 200) {\n        const blockWrapper = paginationElement.closest(`.wp-block-zolo-${blockName}`);\n        if (blockWrapper) {\n          const blockSettings = blockWrapper.dataset.attributes;\n          pageNumber += 1;\n          isLoading = true;\n          if (totalPage >= pageNumber) {\n            fetchContent(blockWrapper, pageNumber, blockSettings);\n          }\n        }\n      }\n    });\n  };\n\n  function initPaginationListeners(paginationElement) {\n    paginationType = paginationElement.dataset.paginationtype;\n    blockName = paginationElement.dataset.blockname;\n    switch (paginationType) {\n      case 'normal':\n        break;\n      case 'number':\n        addClickListeners(paginationElement.querySelectorAll('a'), handlePaginationClick);\n        break;\n      case 'button':\n        handleButtonPagination(paginationElement);\n        break;\n      case 'scroll':\n        handleScrollPagination(paginationElement);\n        break;\n    }\n  }\n\n  const paginationElements = document.querySelectorAll(`.${PAGINATION_WRAP_CLASS}`);\n  paginationElements.forEach(initPaginationListeners);\n});\n"],"names":["document","addEventListener","pageContentCache","Map","PAGINATION_WRAP_CLASS","paginationType","blockName","isLoading","createPreloader","preloader","createElement","classList","add","innerHTML","fetchContent","wrapper","pageNumber","settings","useCache","has","cachedContent","get","insertAdjacentHTML","reinitPaginationListeners","itemWrapper","querySelector","paginationWrap","appendChild","formData","FormData","append","zoloSettings","zolo_nonce","response","fetch","ajaxurl","method","body","result","json","success","set","data","tempDiv","postItems","querySelectorAll","length","forEach","postItem","console","error","removeChild","getPageLink","href","includes","match","getPageNumber","link","parseInt","updatedPaginationElements","initPaginationListeners","handlePaginationClick","event","preventDefault","target","getAttribute","pageLink","closest","dataset","blockname","paginationtype","blockWrapper","blockSettings","attributes","addClickListeners","elements","handler","element","handleButtonPagination","paginationElement","button","pagenumber","remove","handleScrollPagination","totalPage","totalpage","window","scrollPosition","scrollY","innerHeight","documentHeight","documentElement","offsetHeight","paginationElements"],"sourceRoot":""}